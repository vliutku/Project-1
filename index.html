
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Konu Planlayıcı v7</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #1E0000, #500000);
      color: #FFFFFF;
      padding: 30px;
    }
    .top-bar {
      position: relative; height: 140px; margin-bottom: 20px;
    }
    .calc-btn {
      position: absolute; left: 30px; top: 50%; transform: translateY(-50%);
      background: linear-gradient(to right, #843A37, #B75B58);
      color: #FFF; border: none; padding: 12px 24px; border-radius: 8px;
      cursor: pointer; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.5);
      transition: transform 0.3s;
    }
    .calc-btn:hover { transform: translateY(-50%) scale(1.05); }
    .top-bar .logo {
      display: block; margin: 0 auto; height: 120px;
    }
    .header-text {
      position: absolute; right: 30px; top: 50%; transform: translateY(-50%);
      font-size: 12px; color: #FFFFFF;
    }
    .container {
      max-width: 1100px; margin: auto;
      background: rgba(30, 0, 0, 0.8); padding: 30px; border-radius: 15px;
    }
    h2 { text-align: center; color: #FFFFFF; margin-bottom: 20px; }
    label { font-weight: bold; display: block; margin-top: 15px; color: #FFF; }
    input, button, select {
      font-family: 'Poppins', sans-serif;
    }
    input, select {
      width: 100%; padding: 10px; margin-top: 5px;
      background: #300000; border: 1px solid #843A37; border-radius: 8px;
      color: #FFF;
    }
    .row { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px; }
    .row input, .row select { flex: 1; min-width: 120px; }
    button.main-btn {
      background: linear-gradient(to right, #843A37, #B75B58);
      border: none; padding: 12px; width: 100%; border-radius: 10px;
      color: #FFF; font-weight: bold; font-size: 16px; cursor: pointer;
      transition: transform 0.3s; margin-top: 10px;
    }
    button.main-btn:hover { transform: scale(1.03); }
    .days-grid {
      display: flex; flex-wrap: wrap; gap: 20px; margin-top: 30px; justify-content: flex-start;
    }
    .day-card {
      width: calc(20% - 16px); min-width: 160px;
      background: #2E0000; padding: 15px; border-radius: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.5); color: #FFF;
    }
    .gold {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #1E0000; font-weight: bold;
    }
    .day-card strong { display: block; margin-bottom: 10px; font-size: 16px; }
    .day-card ul { padding-left: 18px; margin: 0; color: #FFF; }
  </style>
</head>
<body>
  <div class="top-bar">
    <button class="calc-btn" id="calcBtn">Not Hesaplayıcı</button>
    <img src="7A3688F9-996F-4661-8D84-7BDD44515448.png" alt="Logo" class="logo">
    <div class="header-text">Ali U. - 2030 mezunları</div>
  </div>
  <div class="container">
    <h2>Akıllı Konu Planlayıcı v7</h2>
    <label>Kalan Gün:</label>
    <input type="number" id="days" value="10">
    <label>Günlük Çalışma Süresi (saat):</label>
    <input type="number" id="dailyHours" value="4">
    <label>Tekrar Sayısı (min 1):</label>
    <input type="number" id="repeatCount" value="2" min="1">
    <label>Çıkmış Soru Günü Sayısı (min 2):</label>
    <input type="number" id="exitDays" value="2" min="2">
    <label>Konu Ekle:</label>
    <div class="row">
      <input type="text" id="topicName" placeholder="Konu adı">
      <input type="number" id="importance" placeholder="Önem (1-5)">
      <input type="number" id="noteCount" placeholder="Not sayısı">
      <input type="number" step="0.5" id="noteDuration" placeholder="Süre/not (saat)">
    </div>
    <button class="main-btn" id="addBtn">+ Konu Ekle</button>
    <ul id="topicList" style="margin-top:15px;"></ul>
    <button class="main-btn" id="planBtn">Planı Oluştur</button>
    <div class="days-grid" id="planOutput"></div>
  </div>
  <script>
    const topics = [];
    function addTopic() {
      const tName = document.getElementById('topicName').value.trim();
      const imp = parseInt(document.getElementById('importance').value);
      const count = parseInt(document.getElementById('noteCount').value);
      const dur = parseFloat(document.getElementById('noteDuration').value);
      if(!tName||isNaN(imp)||isNaN(count)||isNaN(dur)){ alert('Tüm alanları doldurun.'); return; }
      topics.push({name:tName,importance:imp,noteCount:count,duration:dur});
      document.getElementById('topicList').innerHTML = topics.map(t=>
        `<li>${t.name} | Önem:${t.importance} | Not:${t.noteCount} | Süre:${t.duration}h</li>`
      ).join('');
      document.getElementById('topicName').value = '';
      document.getElementById('importance').value = '';
      document.getElementById('noteCount').value = '';
      document.getElementById('noteDuration').value = '';
      document.getElementById('topicName').focus();
    }
    const formEls = ['days','dailyHours','repeatCount','exitDays','topicName','importance','noteCount','noteDuration'];
    formEls.forEach(id=>{
      document.getElementById(id).addEventListener('keydown',e=>{
        if(e.key==='Enter'){ e.preventDefault();
          const idx = formEls.indexOf(e.target.id);
          const nxt = formEls[idx+1] || 'addBtn';
          document.getElementById(nxt).focus();
        }
      });
    });
    document.getElementById('addBtn').addEventListener('click',addTopic);
    document.getElementById('calcBtn').addEventListener('click',()=>window.open(
      'https://vliutku.github.io/ankara-tip-hesaplayici-final/?v=1','_blank'
    ));
    document.getElementById('planBtn').addEventListener('click',generatePlan);
    function generatePlan(){
      const totalDays = parseInt(days.value), dailyH = parseFloat(dailyHours.value);
      const reps = Math.max(1,parseInt(repeatCount.value)), exits = Math.max(2,parseInt(exitDays.value));
      const study = totalDays - exits, tasks=[];
      topics.forEach(t=>{
        for(let i=1;i<=t.noteCount;i++) tasks.push({topic:t.name,note:i,duration:t.duration,importance:t.importance});
      });
      tasks.sort((a,b)=>b.importance-a.importance);
      const plan=Array.from({length:study},()=>[]), used=Array(study).fill(0), last={};
      let ptr=0;
      tasks.forEach(task=>{
        for(let i=0;i<study;i++){
          const d=(ptr+i)%study;
          if(used[d]+task.duration<=dailyH && !plan[d].some(x=>x.topic===task.topic) && task.note=== (last[task.topic]||0)+1){
            plan[d].push(task); used[d]+=task.duration; last[task.topic]=task.note; ptr=(d+1)%study; break;
          }
        }
      });
      // repeats offsets
      const offs = Array.from({length:reps},(_,i)=>Math.ceil((i+1)*study/(reps+1))-1);
      Object.entries(last).forEach(([tName,ln])=>{
        offs.forEach(o=>{
          if(o<study && used[o]+topics.find(t=>t.name===tName).duration<=dailyH && plan[o].length<2){
            plan[o].push({topic:tName,note:ln,duration:topics.find(t=>t.name===tName).duration,type:'repeat'}); used[o]+=topics.find(t=>t.name===tName).duration;
          }
        });
      });
      const out = document.getElementById('planOutput'); out.innerHTML='';
      plan.forEach((day,i)=>{
        const div=document.createElement('div'); div.className='day-card';
        div.innerHTML=`<strong>Gün ${i+1}</strong><ul>`+day.map(x=>`<li>${x.topic} - Not ${x.note}${x.type==='repeat'?' [Tekrar]':''} (${x.duration}h)</li>`).join('')+'</ul>';
        out.appendChild(div);
      });
      for(let i=study;i<totalDays;i++){
        const div=document.createElement('div'); div.className='day-card gold';
        div.innerHTML=`<strong>Gün ${i+1} - Çıkmış</strong><ul><li>Çıkmış soru çözümü</li></ul>`;
        out.appendChild(div);
      }
    }
  </script>
</body>
</html>
